<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Tri√¢ngulos Vis√≠veis - Teste</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: white;
            overflow: hidden;
        }
        
        canvas {
            display: block;
            background-color: white;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        // Configura√ß√µes FIXAS para teste
        const CONFIG = {
            showTriangleNodes: true,
            triangleNodeColor: '#FF0000',   // VERMELHO para garantir visibilidade
            triangleNodeSize: 20,           // GRANDE para garantir visibilidade
            triangleNodeSpacing: 4,
            hexSize: 50,
            backgroundColor: '#FFFFFF'
        };
        
        // Array para armazenar cores dos losangos
        let diamondColors = [];
        let boardWidth, boardHeight;
        let hexNodes = [];
        
        // Fun√ß√£o para desenhar n√≥dulo triangular (dois tri√¢ngulos sobrepostos)
        function drawTriangleNode(x, y, size, color, spacing) {
            console.log(`üî∫ TRIANGULO VERMELHO: Desenhando em (${x.toFixed(1)}, ${y.toFixed(1)}) tamanho ${size} cor ${color}`);
            
            ctx.save();
            ctx.fillStyle = color;
            
            // Tri√¢ngulo apontando para a direita
            const rightTriangleX = x + spacing / 2;
            ctx.beginPath();
            ctx.moveTo(rightTriangleX - size/2, y - size/2);  // Ponto superior esquerdo
            ctx.lineTo(rightTriangleX + size/2, y);           // Ponta direita
            ctx.lineTo(rightTriangleX - size/2, y + size/2);  // Ponto inferior esquerdo
            ctx.closePath();
            ctx.fill();
            
            // Tri√¢ngulo apontando para a esquerda
            const leftTriangleX = x - spacing / 2;
            ctx.beginPath();
            ctx.moveTo(leftTriangleX + size/2, y - size/2);   // Ponto superior direito
            ctx.lineTo(leftTriangleX - size/2, y);            // Ponta esquerda
            ctx.lineTo(leftTriangleX + size/2, y + size/2);   // Ponto inferior direito
            ctx.closePath();
            ctx.fill();
            
            ctx.restore();
        }
        
        // Fun√ß√£o simplificada para desenhar losango
        function drawSimpleDiamond(from, to, color) {
            const center = {
                x: (from.x + to.x) / 2.0,
                y: (from.y + to.y) / 2.0
            };
            
            const direction = {
                x: to.x - from.x,
                y: to.y - from.y
            };
            const length = Math.sqrt(direction.x * direction.x + direction.y * direction.y);
            const normalized = {
                x: direction.x / length,
                y: direction.y / length
            };
            
            const perpendicular = {
                x: -normalized.y,
                y: normalized.x
            };
            
            const distance = Math.sqrt((to.x - from.x) ** 2 + (to.y - from.y) ** 2);
            const diamondWidth = distance / (2.0 * Math.sqrt(3.0));
            
            const vertices = [
                from,
                {
                    x: center.x + perpendicular.x * diamondWidth,
                    y: center.y + perpendicular.y * diamondWidth
                },
                to,
                {
                    x: center.x - perpendicular.x * diamondWidth,
                    y: center.y - perpendicular.y * diamondWidth
                }
            ];
            
            ctx.beginPath();
            ctx.moveTo(vertices[0].x, vertices[0].y);
            for (let i = 1; i < vertices.length; i++) {
                ctx.lineTo(vertices[i].x, vertices[i].y);
            }
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();
        }
        
        // Gerar grade hexagonal
        function generateHexGrid() {
            const hexSize = CONFIG.hexSize;
            
            boardWidth = Math.ceil(window.innerWidth / (hexSize * Math.sqrt(3))) + 2;
            boardHeight = Math.ceil(window.innerHeight / (hexSize * 1.5)) + 2;
            hexNodes = [];
            
            for (let row = 0; row < boardHeight; row++) {
                for (let col = 0; col < boardWidth; col++) {
                    const x = hexSize * (Math.sqrt(3.0) * col + Math.sqrt(3.0)/2.0 * (row & 1));
                    const y = hexSize * (3.0/2.0 * row);
                    hexNodes.push({ x, y, col, row, index: row * boardWidth + col });
                }
            }
            
            console.log(`üî∑ Grade gerada: ${hexNodes.length} n√≥s, ${boardWidth}x${boardHeight}`);
        }
        
        // Obter vizinhos hexagonais
        function getHexNeighbors(nodeIdx) {
            const col = nodeIdx % boardWidth;
            const row = Math.floor(nodeIdx / boardWidth);
            const neighbors = [];
            
            let directions;
            if (row % 2 === 0) {
                directions = [[-1,-1], [0,-1], [-1,0], [1,0], [-1,1], [0,1]];
            } else {
                directions = [[0,-1], [1,-1], [-1,0], [1,0], [0,1], [1,1]];
            }
            
            for (const [dx, dy] of directions) {
                const newCol = col + dx;
                const newRow = row + dy;
                if (newCol >= 0 && newCol < boardWidth && newRow >= 0 && newRow < boardHeight) {
                    neighbors.push(newRow * boardWidth + newCol);
                }
            }
            
            return neighbors;
        }
        
        // Ajustar canvas para tela cheia
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            generateHexGrid();
            drawTest();
        }
        
        function drawTest() {
            console.log('üé® Iniciando desenho de teste com tri√¢ngulos VERMELHOS...');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Fundo branco
            ctx.fillStyle = CONFIG.backgroundColor;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            console.log('üìê Canvas:', canvas.width, 'x', canvas.height);
            
            // Desenhar alguns losangos de teste
            console.log('üî∑ Desenhando losangos...');
            const colors = ['#00FF00', '#007E00', '#666666', '#00FFFF'];
            
            for (let i = 0; i < hexNodes.length; i++) {
                const pos = hexNodes[i];
                const neighbors = getHexNeighbors(i);
                
                for (const neighborIdx of neighbors) {
                    if (neighborIdx > i && neighborIdx < hexNodes.length) {
                        const colorIndex = Math.floor(Math.random() * colors.length);
                        drawSimpleDiamond(pos, hexNodes[neighborIdx], colors[colorIndex]);
                    }
                }
            }
            
            console.log('üî∑ Losangos desenhados');
            
            // Desenhar tri√¢ngulos VERMELHOS nos n√≥s
            console.log('üî∫ Desenhando tri√¢ngulos VERMELHOS...');
            
            for (let i = 0; i < hexNodes.length; i++) {
                const pos = hexNodes[i];
                drawTriangleNode(
                    pos.x, 
                    pos.y, 
                    CONFIG.triangleNodeSize, 
                    CONFIG.triangleNodeColor, 
                    CONFIG.triangleNodeSpacing
                );
                
                // Log apenas os primeiros 5 para n√£o poluir o console
                if (i < 5) {
                    console.log(`üî∫ Tri√¢ngulo VERMELHO ${i} desenhado em (${pos.x.toFixed(1)}, ${pos.y.toFixed(1)})`);
                }
            }
            
            console.log(`üî∫ ${hexNodes.length} tri√¢ngulos VERMELHOS desenhados!`);
            console.log('‚úÖ Teste conclu√≠do - tri√¢ngulos devem estar VIS√çVEIS!');
        }
        
        // Inicializa√ß√£o
        window.addEventListener('load', () => {
            console.log('üöÄ Carregando teste de tri√¢ngulos VERMELHOS...');
            resizeCanvas();
        });
        
        window.addEventListener('resize', resizeCanvas);
        
        // Clique para redesenhar
        canvas.addEventListener('click', () => {
            console.log('üñ±Ô∏è Clique detectado - redesenhando...');
            drawTest();
        });
    </script>
</body>
</html>