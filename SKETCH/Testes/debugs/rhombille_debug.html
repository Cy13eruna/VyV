<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Rhombille Debug - N√≥dulos Triangulares</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: white;
            overflow: hidden;
        }
        
        canvas {
            display: block;
            background-color: white;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        // Fun√ß√£o para desenhar n√≥dulo triangular (dois tri√¢ngulos sobrepostos)
        function drawTriangleNode(x, y, size, color, spacing) {
            console.log(`üî∫ Desenhando tri√¢ngulo em (${x.toFixed(1)}, ${y.toFixed(1)}) tamanho ${size} cor ${color}`);
            
            ctx.save();
            ctx.fillStyle = color;
            
            // Tri√¢ngulo apontando para a direita
            const rightTriangleX = x + spacing / 2;
            ctx.beginPath();
            ctx.moveTo(rightTriangleX - size/2, y - size/2);  // Ponto superior esquerdo
            ctx.lineTo(rightTriangleX + size/2, y);           // Ponta direita
            ctx.lineTo(rightTriangleX - size/2, y + size/2);  // Ponto inferior esquerdo
            ctx.closePath();
            ctx.fill();
            
            // Tri√¢ngulo apontando para a esquerda
            const leftTriangleX = x - spacing / 2;
            ctx.beginPath();
            ctx.moveTo(leftTriangleX + size/2, y - size/2);   // Ponto superior direito
            ctx.lineTo(leftTriangleX - size/2, y);            // Ponta esquerda
            ctx.lineTo(leftTriangleX + size/2, y + size/2);   // Ponto inferior direito
            ctx.closePath();
            ctx.fill();
            
            ctx.restore();
        }
        
        // Fun√ß√£o simplificada para desenhar losango
        function drawSimpleDiamond(from, to, color) {
            const center = {
                x: (from.x + to.x) / 2.0,
                y: (from.y + to.y) / 2.0
            };
            
            const direction = {
                x: to.x - from.x,
                y: to.y - from.y
            };
            const length = Math.sqrt(direction.x * direction.x + direction.y * direction.y);
            const normalized = {
                x: direction.x / length,
                y: direction.y / length
            };
            
            const perpendicular = {
                x: -normalized.y,
                y: normalized.x
            };
            
            const distance = Math.sqrt((to.x - from.x) ** 2 + (to.y - from.y) ** 2);
            const diamondWidth = distance / (2.0 * Math.sqrt(3.0));
            
            const vertices = [
                from,
                {
                    x: center.x + perpendicular.x * diamondWidth,
                    y: center.y + perpendicular.y * diamondWidth
                },
                to,
                {
                    x: center.x - perpendicular.x * diamondWidth,
                    y: center.y - perpendicular.y * diamondWidth
                }
            ];
            
            ctx.beginPath();
            ctx.moveTo(vertices[0].x, vertices[0].y);
            for (let i = 1; i < vertices.length; i++) {
                ctx.lineTo(vertices[i].x, vertices[i].y);
            }
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();
        }
        
        // Ajustar canvas para tela cheia
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            drawTest();
        }
        
        function drawTest() {
            console.log('üé® Iniciando desenho de teste...');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Fundo branco
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            console.log('üìê Canvas:', canvas.width, 'x', canvas.height);
            
            // Criar alguns n√≥s de teste
            const testNodes = [
                { x: 100, y: 100 },
                { x: 200, y: 100 },
                { x: 300, y: 100 },
                { x: 150, y: 200 },
                { x: 250, y: 200 }
            ];
            
            // Desenhar alguns losangos de teste
            console.log('üî∑ Desenhando losangos...');
            drawSimpleDiamond(testNodes[0], testNodes[1], '#00FF00');
            drawSimpleDiamond(testNodes[1], testNodes[2], '#007E00');
            drawSimpleDiamond(testNodes[0], testNodes[3], '#666666');
            drawSimpleDiamond(testNodes[1], testNodes[4], '#00FFFF');
            
            // Aguardar um pouco e depois desenhar tri√¢ngulos
            setTimeout(() => {
                console.log('üî∫ Desenhando tri√¢ngulos...');
                
                // Desenhar tri√¢ngulos nos n√≥s
                testNodes.forEach((node, index) => {
                    // Usar cores diferentes para debug
                    const colors = ['#FF0000', '#FFFFFF', '#000000', '#FFFF00', '#FF00FF'];
                    const sizes = [12, 16, 20, 14, 18];
                    
                    drawTriangleNode(node.x, node.y, sizes[index], colors[index], 4);
                });
                
                console.log('‚úÖ Teste conclu√≠do!');
            }, 100);
        }
        
        // Inicializa√ß√£o
        window.addEventListener('load', () => {
            console.log('üöÄ Carregando teste de n√≥dulos triangulares...');
            resizeCanvas();
        });
        
        window.addEventListener('resize', resizeCanvas);
        
        // Clique para redesenhar
        canvas.addEventListener('click', () => {
            console.log('üñ±Ô∏è Clique detectado - redesenhando...');
            drawTest();
        });
    </script>
</body>
</html>